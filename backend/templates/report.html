<!DOCTYPE html>
<html lang="{{lang}}" dir="{{direction}}">
<head>
  <meta charset="UTF-8" />
  <title>{{title}}</title>

  <!-- Force Zero Margin for PDF -->
  <style>
    @page {
      margin: 0;
    }
  </style>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700;800&display=swap');
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap');

    body {
      font-family: "Cairo", "Inter", Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: #f3f4f6;
      color: #333;
      direction: {{direction}};
    }

    .page {
      width: 100%;
      min-height: 100%;
      padding: 17mm 20mm;
      background: white;
      box-sizing: border-box;
    }

    /* ======================== HEADER ======================== */
    .header {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding-bottom: 18px;
      margin-bottom: 22px;
      border-bottom: 4px solid #0f766e;
    }

    .logo {
      max-width: 150px;
      margin-bottom: 10px;
    }

    .title {
      font-size: 30px;
      font-weight: 800;
      color: #0f766e;
      margin-bottom: 3px;
    }

    .sub {
      font-size: 14px;
      color: #555;
      font-weight: 500;
    }

    /* ======================== SECTIONS ======================== */
    .section-title {
      font-size: 20px;
      font-weight: 700;
      margin-top: 28px;
      margin-bottom: 12px;
      color: #0f766e;
      border-inline-start: 6px solid #0f766e;
      padding-inline-start: 12px;
    }

    /* ======================== SUMMARY BOX ======================== */
    .summary-box {
      background: #ecfdf5;
      border: 2px solid #a7f3d0;
      padding: 18px 20px;
      border-radius: 12px;
      margin-bottom: 22px;
    }

    .summary-item {
      font-size: 16px;
      margin: 8px 0;
      font-weight: 600;
    }

    .summary-item strong {
      color: #0f766e;
      margin-inline-start: 5px;
    }

    /* ======================== TABLES ======================== */

    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 30px;
      font-size: 14px;
    }

    th {
      background: #0f766e;
      color: #fff;
      padding: 10px;
      border: 1px solid #0d5f57;
      font-weight: 700;

      /* Prevent wrapping */
      white-space: nowrap;
    }

    td {
      padding: 8px;
      border: 1px solid #ccc;
      text-align: center;
      background: #fff;

      /* Prevent text wrap */
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: 180px;
    }

    tr:nth-child(even) td {
      background: #f9fafb;
    }

    /* =============== PAGE BREAK =============== */
    .page-break {
      page-break-before: always;
    }

    /* =============== FOOTER =============== */
    .footer {
      margin-top: 20px;
      font-size: 12px;
      color: #777;
      text-align: center;
    }

    /* Inject custom inline css */
    {{{inlineCSS}}}
  </style>
</head>

<body>
  <div class="page">

    <!-- HEADER -->
    <div class="header">
      {{#if logo}}
        <img src="{{logo}}" class="logo" />
      {{/if}}
      <div class="title">{{title}}</div>
      <div class="sub">{{subtitle}}</div>
    </div>

    <!-- SUMMARY -->
    <div class="section-title">{{summaryTitle}}</div>
    <div class="summary-box">
      {{{summaryHTML}}}
    </div>

    <!-- DETAILS TABLES -->
    {{#if detailsTableHTML}}
      <div class="section-title">{{detailsTitle}}</div>
      {{{detailsTableHTML}}}
    {{/if}}

    <!-- SECONDARY TABLES -->
    {{{secondaryTablesHTML}}}

    <!-- FOOTER -->
    <div class="footer">{{footerText}}</div>
  </div>
</body>
</html>
